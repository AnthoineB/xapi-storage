
<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <title>volume</title>

    <style>
      .highlight table td { padding: 5px; }
.highlight table pre { margin: 0; }
.highlight .gh {
  color: #999999;
}
.highlight .sr {
  color: #f6aa11;
}
.highlight .go {
  color: #888888;
}
.highlight .gp {
  color: #555555;
}
.highlight .gs {
}
.highlight .gu {
  color: #aaaaaa;
}
.highlight .nb {
  color: #f6aa11;
}
.highlight .cm {
  color: #75715e;
}
.highlight .cp {
  color: #75715e;
}
.highlight .c1 {
  color: #75715e;
}
.highlight .cs {
  color: #75715e;
}
.highlight .c, .highlight .cd {
  color: #75715e;
}
.highlight .err {
  color: #960050;
}
.highlight .gr {
  color: #960050;
}
.highlight .gt {
  color: #960050;
}
.highlight .gd {
  color: #49483e;
}
.highlight .gi {
  color: #49483e;
}
.highlight .ge {
  color: #49483e;
}
.highlight .kc {
  color: #66d9ef;
}
.highlight .kd {
  color: #66d9ef;
}
.highlight .kr {
  color: #66d9ef;
}
.highlight .no {
  color: #66d9ef;
}
.highlight .kt {
  color: #66d9ef;
}
.highlight .mf {
  color: #ae81ff;
}
.highlight .mh {
  color: #ae81ff;
}
.highlight .il {
  color: #ae81ff;
}
.highlight .mi {
  color: #ae81ff;
}
.highlight .mo {
  color: #ae81ff;
}
.highlight .m, .highlight .mb, .highlight .mx {
  color: #ae81ff;
}
.highlight .sc {
  color: #ae81ff;
}
.highlight .se {
  color: #ae81ff;
}
.highlight .ss {
  color: #ae81ff;
}
.highlight .sd {
  color: #e6db74;
}
.highlight .s2 {
  color: #e6db74;
}
.highlight .sb {
  color: #e6db74;
}
.highlight .sh {
  color: #e6db74;
}
.highlight .si {
  color: #e6db74;
}
.highlight .sx {
  color: #e6db74;
}
.highlight .s1 {
  color: #e6db74;
}
.highlight .s {
  color: #e6db74;
}
.highlight .na {
  color: #a6e22e;
}
.highlight .nc {
  color: #a6e22e;
}
.highlight .nd {
  color: #a6e22e;
}
.highlight .ne {
  color: #a6e22e;
}
.highlight .nf {
  color: #a6e22e;
}
.highlight .vc {
  color: #ffffff;
}
.highlight .nn {
  color: #ffffff;
}
.highlight .nl {
  color: #ffffff;
}
.highlight .ni {
  color: #ffffff;
}
.highlight .bp {
  color: #ffffff;
}
.highlight .vg {
  color: #ffffff;
}
.highlight .vi {
  color: #ffffff;
}
.highlight .nv {
  color: #ffffff;
}
.highlight .w {
  color: #ffffff;
}
.highlight {
  color: #ffffff;
}
.highlight .n, .highlight .py, .highlight .nx {
  color: #ffffff;
}
.highlight .ow {
  color: #f92672;
}
.highlight .nt {
  color: #f92672;
}
.highlight .k, .highlight .kv {
  color: #f92672;
}
.highlight .kn {
  color: #f92672;
}
.highlight .kp {
  color: #f92672;
}
.highlight .o {
  color: #f92672;
}
    </style>
    <link href="../stylesheets/screen.css" rel="stylesheet" media="screen" />
    <link href="../stylesheets/print.css" rel="stylesheet" media="print" />
      <script src="../javascripts/all.js"></script>
  </head>

  <body class="includes includes_volume" data-languages="[&quot;json&quot;,&quot;ocaml&quot;,&quot;python&quot;]">
    <a href="#" id="nav-button">
      <span>
        NAV
        <img src="../images/navbar.png" alt="Navbar" />
      </span>
    </a>
    <div class="toc-wrapper">
      <img src="../images/logo.png" class="logo" alt="Logo" />
        <div class="lang-selector">
              <a href="#" data-language-name="json">json</a>
              <a href="#" data-language-name="ocaml">ocaml</a>
              <a href="#" data-language-name="python">python</a>
        </div>
        <div class="search">
          <input type="text" class="search" id="input-search" placeholder="Search">
        </div>
        <ul class="search-results"></ul>
      <div id="toc" class="toc-list-h1">
          <li>
            <a href="#volume" class="toc-h1 toc-link" data-title="volume">volume</a>
              <ul class="toc-list-h2">
                  <li>
                    <a href="#type-definitions" class="toc-h2 toc-link" data-title="type-definitions">Type definitions</a>
                  </li>
                  <li>
                    <a href="#interface-sr" class="toc-h2 toc-link" data-title="interface-code-sr-code">Interface: <code>SR</code></a>
                  </li>
                  <li>
                    <a href="#method-probe" class="toc-h2 toc-link" data-title="method-code-probe-code">Method: <code>probe</code></a>
                  </li>
                  <li>
                    <a href="#method-create" class="toc-h2 toc-link" data-title="method-code-create-code">Method: <code>create</code></a>
                  </li>
                  <li>
                    <a href="#method-attach" class="toc-h2 toc-link" data-title="method-code-attach-code">Method: <code>attach</code></a>
                  </li>
                  <li>
                    <a href="#method-detach" class="toc-h2 toc-link" data-title="method-code-detach-code">Method: <code>detach</code></a>
                  </li>
                  <li>
                    <a href="#method-destroy" class="toc-h2 toc-link" data-title="method-code-destroy-code">Method: <code>destroy</code></a>
                  </li>
                  <li>
                    <a href="#method-stat" class="toc-h2 toc-link" data-title="method-code-stat-code">Method: <code>stat</code></a>
                  </li>
                  <li>
                    <a href="#method-set_name" class="toc-h2 toc-link" data-title="method-code-set_name-code">Method: <code>set_name</code></a>
                  </li>
                  <li>
                    <a href="#method-set_description" class="toc-h2 toc-link" data-title="method-code-set_description-code">Method: <code>set_description</code></a>
                  </li>
                  <li>
                    <a href="#method-ls" class="toc-h2 toc-link" data-title="method-code-ls-code">Method: <code>ls</code></a>
                  </li>
                  <li>
                    <a href="#interface-volume" class="toc-h2 toc-link" data-title="interface-code-volume-code">Interface: <code>Volume</code></a>
                  </li>
                  <li>
                    <a href="#method-create-2" class="toc-h2 toc-link" data-title="method-code-create-code">Method: <code>create</code></a>
                  </li>
                  <li>
                    <a href="#method-snapshot" class="toc-h2 toc-link" data-title="method-code-snapshot-code">Method: <code>snapshot</code></a>
                  </li>
                  <li>
                    <a href="#method-clone" class="toc-h2 toc-link" data-title="method-code-clone-code">Method: <code>clone</code></a>
                  </li>
                  <li>
                    <a href="#method-destroy-2" class="toc-h2 toc-link" data-title="method-code-destroy-code">Method: <code>destroy</code></a>
                  </li>
                  <li>
                    <a href="#method-set_name-2" class="toc-h2 toc-link" data-title="method-code-set_name-code">Method: <code>set_name</code></a>
                  </li>
                  <li>
                    <a href="#method-set_description-2" class="toc-h2 toc-link" data-title="method-code-set_description-code">Method: <code>set_description</code></a>
                  </li>
                  <li>
                    <a href="#method-set" class="toc-h2 toc-link" data-title="method-code-set-code">Method: <code>set</code></a>
                  </li>
                  <li>
                    <a href="#method-unset" class="toc-h2 toc-link" data-title="method-code-unset-code">Method: <code>unset</code></a>
                  </li>
                  <li>
                    <a href="#method-resize" class="toc-h2 toc-link" data-title="method-code-resize-code">Method: <code>resize</code></a>
                  </li>
                  <li>
                    <a href="#method-stat-2" class="toc-h2 toc-link" data-title="method-code-stat-code">Method: <code>stat</code></a>
                  </li>
                  <li>
                    <a href="#method-compare" class="toc-h2 toc-link" data-title="method-code-compare-code">Method: <code>compare</code></a>
                  </li>
                  <li>
                    <a href="#method-similar_content" class="toc-h2 toc-link" data-title="method-code-similar_content-code">Method: <code>similar_content</code></a>
                  </li>
                  <li>
                    <a href="#method-enable_cbt" class="toc-h2 toc-link" data-title="method-code-enable_cbt-code">Method: <code>enable_cbt</code></a>
                  </li>
                  <li>
                    <a href="#method-disable_cbt" class="toc-h2 toc-link" data-title="method-code-disable_cbt-code">Method: <code>disable_cbt</code></a>
                  </li>
                  <li>
                    <a href="#method-data_destroy" class="toc-h2 toc-link" data-title="method-code-data_destroy-code">Method: <code>data_destroy</code></a>
                  </li>
                  <li>
                    <a href="#method-list_changed_blocks" class="toc-h2 toc-link" data-title="method-code-list_changed_blocks-code">Method: <code>list_changed_blocks</code></a>
                  </li>
                  <li>
                    <a href="#errors" class="toc-h2 toc-link" data-title="errors">Errors</a>
                  </li>
              </ul>
          </li>
      </div>
    </div>
    <div class="page-wrapper">
      <div class="dark-box"></div>
      <div class="content">
        <h1 id='volume'>volume</h1>
<p>The xapi toolstack delegates all storage control-plane functions to  &quot;Volume plugins&quot;.These plugins allow the toolstack to  create/destroy/snapshot/clone volumes which are organised into groups  called Storage Repositories (SR). Volumes have a set of URIs which  can be used by the &quot;Datapath plugins&quot; to connect the disk data to  VMs.</p>
<h2 id='type-definitions'>Type definitions</h2><h3 id='probe_results'>probe_results</h3><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"extra_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"extra_info"</span><span class="p">:</span><span class="w"> </span><span class="s2">"extra_info"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"health"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="p">,</span><span class="w"> </span><span class="s2">"health"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="s2">"clustered"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"datasources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"datasources"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="s2">"total_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"free_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"complete"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span><span class="p">[]</span><span class="w">
</span></code></pre>
<p>type <code>probe_results</code> = struct  { ... } list</p>
<h3 id='configuration'>configuration</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="s2">"configuration"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>type <code>configuration</code> = (string * string) list
Plugin-specific configuration which describes where and; how to locate the storage repository. This may include; the physical block device name, a remote NFS server and; path or an RBD storage pool.</p>
<h3 id='sr_stat'>sr_stat</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"health"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="p">,</span><span class="w"> </span><span class="s2">"health"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"clustered"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"datasources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"datasources"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"total_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"free_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>type <code>sr_stat</code> = struct  { ... }
A set of high-level properties associated with an SR. These properties can change dynamically and can be queried by a SR.stat call.</p>
<h4 id='members'>Members</h4>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>sr</td>
<td>string</td>
<td>The URI identifying this volume. A typical value would be a file:// URI pointing to a directory or block device</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Short, human-readable label for the SR.</td>
</tr>
<tr>
<td>uuid</td>
<td>string option</td>
<td>Uuid that uniquely identifies this SR, if one is available. For SRs that are created by SR.create, this should be the value passed into that call, if it is possible to persist it.</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>Longer, human-readable description of the SR. Descriptions are generally only displayed by clients when the user is examining SRs in detail.</td>
</tr>
<tr>
<td>free_space</td>
<td>int64</td>
<td>Number of bytes free on the backing storage (in bytes)</td>
</tr>
<tr>
<td>total_space</td>
<td>int64</td>
<td>Total physical size of the backing storage (in bytes)</td>
</tr>
<tr>
<td>datasources</td>
<td>string list</td>
<td>URIs naming datasources: time-varying quantities representing anything from disk access latency to free space. The entities named by these URIs are self-describing.</td>
</tr>
<tr>
<td>clustered</td>
<td>bool</td>
<td>Indicates whether the SR uses clustered local storage.</td>
</tr>
<tr>
<td>health</td>
<td>variant { ... }</td>
<td>The health status of the SR.</td>
</tr>
</tbody></table>
<h3 id='volumes'>volumes</h3><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="s2">"keys"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri"</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span><span class="p">[]</span><span class="w">
</span></code></pre>
<p>type <code>volumes</code> = struct  { ... } list
A list of volumes</p>
<h3 id='key'>key</h3><pre class="highlight json tab-json"><code><span class="s2">"key"</span><span class="w">
</span></code></pre>
<p>type <code>key</code> = string
Primary key for a volume. This can be any string which is meaningful to the implementation. For example this could be an NFS filename, an LVM LV name or even a URI. This string is abstract.</p>
<h3 id='volume-2'>volume</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="s2">"keys"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre>
<p>type <code>volume</code> = struct  { ... }
A set of properties associated with a volume. These properties can change dynamically and can be queried by the Volume.stat call.</p>
<h4 id='members-2'>Members</h4>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>key</td>
<td>string</td>
<td>A primary key for this volume. The key must be unique within the enclosing Storage Repository (SR). A typical value would be a filename or an LVM volume name.</td>
</tr>
<tr>
<td>uuid</td>
<td>string option</td>
<td>A uuid (or guid) for the volume, if one is available. If a storage system has a built-in notion of a guid, then it will be returned here.</td>
</tr>
<tr>
<td>name</td>
<td>string</td>
<td>Short, human-readable label for the volume. Names are commonly used by when displaying short lists of volumes.</td>
</tr>
<tr>
<td>description</td>
<td>string</td>
<td>Longer, human-readable description of the volume. Descriptions are generally only displayed by clients when the user is examining volumes individually.</td>
</tr>
<tr>
<td>read_write</td>
<td>bool</td>
<td>True means the VDI may be written to, false means the volume is read-only. Some storage media is read-only so all volumes are read-only; for example .iso disk images on an NFS share. Some volume are created read-only; for example because they are snapshots of some other VDI.</td>
</tr>
<tr>
<td>sharable</td>
<td>bool</td>
<td>Indicates whether the VDI can be attached by multiple hosts at once. This is used for example by the HA statefile and XAPI redo log.</td>
</tr>
<tr>
<td>virtual_size</td>
<td>int64</td>
<td>Size of the volume from the perspective of a VM (in bytes)</td>
</tr>
<tr>
<td>physical_utilisation</td>
<td>int64</td>
<td>Amount of space currently used on the backing storage (in bytes)</td>
</tr>
<tr>
<td>uri</td>
<td>string list</td>
<td>A list of URIs which can be opened and used for I/O. A URI could reference a local block device, a remote NFS share, iSCSI LUN or RBD volume. In cases where the data may be accessed over several protocols, he list should be sorted into descending order of desirability. Xapi will open the most desirable URI for which it has an available datapath plugin.</td>
</tr>
<tr>
<td>keys</td>
<td>(string * string) list</td>
<td>A list of key=value pairs which have been stored in the Volume metadata. These should not be interpreted by the Volume plugin.</td>
</tr>
</tbody></table>
<h3 id='blocklist'>blocklist</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"ranges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="s2">"blocksize"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>type <code>blocklist</code> = struct  { ... }
List of blocks for copying</p>
<h4 id='members-3'>Members</h4>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>blocksize</td>
<td>int</td>
<td>size of the individual blocks</td>
</tr>
<tr>
<td>ranges</td>
<td>int64 * int64 list</td>
<td>list of block ranges, where a range is a (start,length) pair, measured in units of [blocksize]</td>
</tr>
</tbody></table>
<h3 id='key_list'>key_list</h3><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w"> </span><span class="s2">"key_list"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[]</span><span class="w">
</span></code></pre>
<p>type <code>key_list</code> = string list</p>
<h3 id='changed_blocks'>changed_blocks</h3><pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"bitmap"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bitmap"</span><span class="p">,</span><span class="w"> </span><span class="s2">"granularity"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre>
<p>type <code>changed_blocks</code> = struct  { ... }</p>
<h4 id='members-4'>Members</h4>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>granularity</td>
<td>int</td>
<td></td>
</tr>
<tr>
<td>bitmap</td>
<td>string</td>
<td>The changed blocks between two volumes as a base64-encoded string</td>
</tr>
</tbody></table>
<h2 id='interface-sr'>Interface: <code>SR</code></h2>
<p>Operations which act on Storage Repositories</p>
<h2 id='method-probe'>Method: <code>probe</code></h2>
<p>[probe configuration]: can be used iteratively to narrow down configurations to use with SR.create, or to find existing SRs on the backing storage</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.probe"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">probe_result</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">probe</span> <span class="n">dbg</span> <span class="n">configuration</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">probe</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">configuration</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"extra_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"health"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="s2">"clustered"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"datasources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"datasources_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"datasources_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="s2">"total_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"free_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"complete"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"extra_info"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w">
      </span><span class="s2">"health"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="s2">"clustered"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"datasources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"datasources_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"datasources_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
      </span><span class="s2">"total_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"free_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="w">
    </span><span class="p">},</span><span class="w">
    </span><span class="s2">"complete"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">probe_result</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">probe</span> <span class="n">dbg</span> <span class="n">configuration</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">probe</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">configuration</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"probe_result"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span> <span class="s">"configuration"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">},</span> <span class="s">"complete"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sr"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"extra_info"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">},</span> <span class="p">{</span> <span class="s">"configuration"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">},</span> <span class="s">"complete"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sr"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"extra_info"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">}</span> <span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>configuration</td>
<td>in</td>
<td>configuration</td>
<td>Plugin-specific configuration which describes where and how to locate the storage repository. This may include the physical block device name, a remote NFS server and path or an RBD storage pool.</td>
</tr>
<tr>
<td>probe_result</td>
<td>out</td>
<td>probe_results</td>
<td>Contents of the storage device</td>
</tr>
</tbody></table>
<h2 id='method-create'>Method: <code>create</code></h2>
<p>[create uuid configuration name description]: creates a fresh SR</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.create"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"uuid"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">configuration</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">create</span> <span class="n">dbg</span> <span class="n">uuid</span> <span class="n">configuration</span> <span class="n">name</span> <span class="n">description</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">create</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">uuid</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">configuration</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">},</span> <span class="n">name</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">configuration</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">create</span> <span class="n">dbg</span> <span class="n">uuid</span> <span class="n">configuration</span> <span class="n">name</span> <span class="n">description</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">uuid</span><span class="p">,</span> <span class="n">configuration</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"configuration"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>uuid</td>
<td>in</td>
<td>string</td>
<td>A uuid to associate with the SR.</td>
</tr>
<tr>
<td>configuration</td>
<td>in</td>
<td>configuration</td>
<td>Plugin-specific configuration which describes where and how to locate the storage repository. This may include the physical block device name, a remote NFS server and path or an RBD storage pool.</td>
</tr>
<tr>
<td>name</td>
<td>in</td>
<td>string</td>
<td>Human-readable name for the SR</td>
</tr>
<tr>
<td>description</td>
<td>in</td>
<td>string</td>
<td>Human-readable description for the SR</td>
</tr>
<tr>
<td>configuration</td>
<td>out</td>
<td>configuration</td>
<td>Plugin-specific configuration which describes where and how to locate the storage repository. This may include the physical block device name, a remote NFS server and path or an RBD storage pool.</td>
</tr>
</tbody></table>
<h2 id='method-attach'>Method: <code>attach</code></h2>
<p>[attach configuration]: attaches the SR to the local host. Once an SR is  attached then volumes may be manipulated.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.attach"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"configuration"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
      </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">sr</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">attach</span> <span class="n">dbg</span> <span class="n">configuration</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">attach</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">configuration</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="s2">"sr"</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">sr</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">attach</span> <span class="n">dbg</span> <span class="n">configuration</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">attach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">configuration</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"sr"</span><span class="p">]</span> <span class="o">=</span> <span class="s">"string"</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>configuration</td>
<td>in</td>
<td>configuration</td>
<td>Plugin-specific configuration which describes where and how to locate the storage repository. This may include the physical block device name, a remote NFS server and path or an RBD storage pool.</td>
</tr>
<tr>
<td>sr</td>
<td>out</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
</tbody></table>
<h2 id='method-detach'>Method: <code>detach</code></h2>
<p>[detach sr]: detaches the SR, clearing up any associated resources.  Once the SR is detached then volumes may not be manipulated.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.detach"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">7</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">detach</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">detach</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">detach</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">detach</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
</tbody></table>
<h2 id='method-destroy'>Method: <code>destroy</code></h2>
<p>[destroy sr]: destroys the [sr] and deletes any volumes associated  with it. Note that an SR must be attached to be destroyed; otherwise  Sr_not_attached is thrown.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.destroy"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">destroy</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">destroy</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">destroy</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
</tbody></table>
<h2 id='method-stat'>Method: <code>stat</code></h2>
<p>[stat sr] returns summary metadata associated with [sr]. Note this  call does not return details of sub-volumes, see SR.ls.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.stat"</span><span class="p">,</span><span class="w"> </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">9</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">sr</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">stat</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">stat</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"health"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="p">,</span><span class="w"> </span><span class="s2">"Healthy"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"clustered"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"datasources"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"datasources_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"datasources_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"total_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"free_space"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">sr</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">stat</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"sr"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"sr"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"uuid"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"free_space"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"total_space"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"datasources"</span><span class="p">:</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">],</span> <span class="s">"clustered"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"health"</span><span class="p">:</span> <span class="bp">None</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>sr</td>
<td>out</td>
<td>sr_stat</td>
<td>SR metadata</td>
</tr>
</tbody></table>
<h2 id='method-set_name'>Method: <code>set_name</code></h2>
<p>[set_name sr new_name] changes the name of [sr]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.set_name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"new_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"new_name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_name</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">new_name</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">set_name</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_name</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">new_name</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>new_name</td>
<td>in</td>
<td>string</td>
<td>The new name of the SR</td>
</tr>
</tbody></table>
<h2 id='method-set_description'>Method: <code>set_description</code></h2>
<p>[set_description sr new_description] changes the description of [sr]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.set_description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"new_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"new_description"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">11</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_description</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">new_description</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">set_description</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">new_description</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_description</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">new_description</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">set_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">new_description</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>new_description</td>
<td>in</td>
<td>string</td>
<td>The new description for the SR</td>
</tr>
</tbody></table>
<h2 id='method-ls'>Method: <code>ls</code></h2>
<p>[ls sr] returns a list of volumes contained within an attached SR.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"SR.ls"</span><span class="p">,</span><span class="w"> </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volumes</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">ls</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">SR</span><span class="o">.</span><span class="n">ls</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
  </span><span class="p">},</span><span class="w">
  </span><span class="p">{</span><span class="w">
    </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
    </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
    </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
    </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
    </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
    </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
  </span><span class="p">}</span><span class="w">
</span><span class="p">]</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volumes</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">ls</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">SR_myimplementation</span><span class="p">(</span><span class="n">SR_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">ls</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">):</span>
        <span class="s">"""Operations which act on Storage Repositories"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"volumes"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="p">{</span> <span class="s">"key"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"uuid"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"read_write"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sharable"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"virtual_size"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"physical_utilisation"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"uri"</span><span class="p">:</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">],</span> <span class="s">"keys"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">},</span> <span class="p">{</span> <span class="s">"key"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"uuid"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"read_write"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sharable"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"virtual_size"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"physical_utilisation"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"uri"</span><span class="p">:</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">],</span> <span class="s">"keys"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">}</span> <span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>volumes</td>
<td>out</td>
<td>volumes</td>
<td>A list of volumes</td>
</tr>
</tbody></table>
<h2 id='interface-volume'>Interface: <code>Volume</code></h2>
<p>Operations which operate on volumes (also known as  Virtual Disk Images)</p>
<h2 id='method-create-2'>Method: <code>create</code></h2>
<p>[create sr name description size] creates a new volume in [sr] with  [name] and [description]. The volume will have size &gt;= [size] i.e. it  is always permissable for an implementation to round-up the volume to  the nearest convenient block size</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.create"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
      </span><span class="s2">"size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">13</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">create</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">name</span> <span class="n">description</span> <span class="n">size</span> <span class="n">sharable</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">create</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">size</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="n">sharable</span><span class="p">:</span> <span class="bp">True</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">create</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">name</span> <span class="n">description</span> <span class="n">size</span> <span class="n">sharable</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">description</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">sharable</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"volume"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"key"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"uuid"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"read_write"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sharable"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"virtual_size"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"physical_utilisation"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"uri"</span><span class="p">:</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">],</span> <span class="s">"keys"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>name</td>
<td>in</td>
<td>string</td>
<td>A human-readable name to associate with the new disk. This name is  intended to be short, to be a good summary of the disk.</td>
</tr>
<tr>
<td>description</td>
<td>in</td>
<td>string</td>
<td>A human-readable description to associate with the new disk. This can  be arbitrarily long, up to the general string size limit.</td>
</tr>
<tr>
<td>size</td>
<td>in</td>
<td>int64</td>
<td>A minimum size (in bytes) for the disk. Depending on the  characteristics of the implementation this may be rounded up to  (for example) the nearest convenient block size. The created disk  will not be smaller than this size.</td>
</tr>
<tr>
<td>sharable</td>
<td>in</td>
<td>bool</td>
<td>Indicates whether the VDI can be attached by multiple hosts at once. This is used for example by the HA statefile and XAPI redo log.</td>
</tr>
<tr>
<td>volume</td>
<td>out</td>
<td>volume</td>
<td>Properties of the volume</td>
</tr>
</tbody></table>
<h2 id='method-snapshot'>Method: <code>snapshot</code></h2>
<p>[snapshot sr volume] creates a new volue which is a  snapshot of  [volume] in [sr]. Snapshots should never be written to; they are  intended for backup/restore only. Note the name and description are  copied but any extra metadata associated by [set] is not copied. This can raise Activated_on_another_host(host_installation_uuid) if the VDI is already active on another host and snapshots can only be taken on the host that has the VDI active (if any). XAPI will take care of redirecting the request to the proper host</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.snapshot"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">14</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">snapshot</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">snapshot</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">snapshot</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">snapshot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"volume"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"key"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"uuid"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"read_write"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sharable"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"virtual_size"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"physical_utilisation"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"uri"</span><span class="p">:</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">],</span> <span class="s">"keys"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>volume</td>
<td>out</td>
<td>volume</td>
<td>Properties of the volume</td>
</tr>
</tbody></table>
<h2 id='method-clone'>Method: <code>clone</code></h2>
<p>[clone sr volume] creates a new volume which is a writable clone of  [volume] in [sr]. Note the name and description are copied but any  extra metadata associated by [set] is not copied.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.clone"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">clone</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">clone</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">clone</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">clone</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"volume"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"key"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"uuid"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"read_write"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sharable"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"virtual_size"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"physical_utilisation"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"uri"</span><span class="p">:</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">],</span> <span class="s">"keys"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>volume</td>
<td>out</td>
<td>volume</td>
<td>Properties of the volume</td>
</tr>
</tbody></table>
<h2 id='method-destroy-2'>Method: <code>destroy</code></h2>
<p>[destroy sr volume] removes [volume] from [sr]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.destroy"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">16</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">destroy</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">destroy</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">destroy</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
</tbody></table>
<h2 id='method-set_name-2'>Method: <code>set_name</code></h2>
<p>[set_name sr volume new_name] changes the name of [volume]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.set_name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"new_name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"new_name"</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">17</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_name</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">new_name</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">set_name</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">new_name</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_name</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">new_name</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">set_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">new_name</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>new_name</td>
<td>in</td>
<td>string</td>
<td>New name</td>
</tr>
</tbody></table>
<h2 id='method-set_description-2'>Method: <code>set_description</code></h2>
<p>[set_description sr volume new_description] changes the description  of [volume]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.set_description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"new_description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"new_description"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_description</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">new_description</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">set_description</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">new_description</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set_description</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">new_description</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">set_description</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">new_description</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>new_description</td>
<td>in</td>
<td>string</td>
<td>New description</td>
</tr>
</tbody></table>
<h2 id='method-set'>Method: <code>set</code></h2>
<p>[set sr volume key value] associates [key] with [value] in the  metadata of [volume] Note these keys and values are not interpreted  by the plugin; they are intended for the higher-level software only.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.set"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w"> </span><span class="s2">"v"</span><span class="p">:</span><span class="w"> </span><span class="s2">"v"</span><span class="p">,</span><span class="w"> </span><span class="s2">"k"</span><span class="p">:</span><span class="w"> </span><span class="s2">"k"</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">k</span> <span class="n">v</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="nb">set</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">v</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">set</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">k</span> <span class="n">v</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>k</td>
<td>in</td>
<td>string</td>
<td>Key</td>
</tr>
<tr>
<td>v</td>
<td>in</td>
<td>string</td>
<td>Value</td>
</tr>
</tbody></table>
<h2 id='method-unset'>Method: <code>unset</code></h2>
<p>[unset sr volume key] removes [key] and any value associated with it  from the metadata of [volume] Note these keys and values are not  interpreted by the plugin; they are intended for the higher-level  software only.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.unset"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"k"</span><span class="p">:</span><span class="w"> </span><span class="s2">"k"</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">unset</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">k</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">unset</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">k</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">unset</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">k</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">unset</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>k</td>
<td>in</td>
<td>string</td>
<td>Key</td>
</tr>
</tbody></table>
<h2 id='method-resize'>Method: <code>resize</code></h2>
<p>[resize sr volume new_size] enlarges [volume] to be at least  [new_size].</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.resize"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"new_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">21</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">resize</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">new_size</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">resize</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">new_size</span><span class="p">:</span> <span class="il">0L</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">resize</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">new_size</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">resize</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">new_size</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>new_size</td>
<td>in</td>
<td>int64</td>
<td>New disk size</td>
</tr>
</tbody></table>
<h2 id='method-stat-2'>Method: <code>stat</code></h2>
<p>[stat sr volume] returns metadata associated with [volume].</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.stat"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">stat</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">stat</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"keys"</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"field_1"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"field_2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"value_2"</span><span class="w"> </span><span class="p">},</span><span class="w">
  </span><span class="s2">"uri"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="s2">"uri_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"uri_2"</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"physical_utilisation"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"virtual_size"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
  </span><span class="s2">"sharable"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"read_write"</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w">
  </span><span class="s2">"description"</span><span class="p">:</span><span class="w"> </span><span class="s2">"description"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"name"</span><span class="p">:</span><span class="w"> </span><span class="s2">"name"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"uuid"</span><span class="p">:</span><span class="w"> </span><span class="s2">"optional_uuid"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">volume</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">stat</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">stat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"volume"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"key"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"uuid"</span><span class="p">:</span> <span class="bp">None</span><span class="p">,</span> <span class="s">"name"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"description"</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"read_write"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"sharable"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span> <span class="s">"virtual_size"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"physical_utilisation"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"uri"</span><span class="p">:</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">],</span> <span class="s">"keys"</span><span class="p">:</span> <span class="p">{</span> <span class="s">"string"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>volume</td>
<td>out</td>
<td>volume</td>
<td>Properties of the volume</td>
</tr>
</tbody></table>
<h2 id='method-compare'>Method: <code>compare</code></h2>
<p>[compare sr volume1 volume2] compares the two volumes and returns a  result of type blocklist that describes the differences between the  two volumes. If the two volumes are unrelated, or the second volume  does not exist, the result will be a list of the blocks that are  non-empty in volume1. If this information is not available to the  plugin, it should return a result indicating that all blocks are in  use.</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.compare"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key2"</span><span class="p">,</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">23</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">blocklist</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">compare</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">key2</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">compare</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key2</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"ranges"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">]</span><span class="w"> </span><span class="p">],</span><span class="w"> </span><span class="s2">"blocksize"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">blocklist</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">compare</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">key2</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">compare</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">key2</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"blocksize"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"ranges"</span><span class="p">:</span> <span class="p">[</span> <span class="p">[],</span> <span class="p">[]</span> <span class="p">]</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>key2</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>unnamed</td>
<td>out</td>
<td>blocklist</td>
<td>List of blocks for copying</td>
</tr>
</tbody></table>
<h2 id='method-similar_content'>Method: <code>similar_content</code></h2>
<p>[similar_content sr volume] returns a list of VDIs which have similar content to [vdi]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.similar_content"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">24</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">key</span> <span class="kt">list</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">similar_content</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">similar_content</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">[</span><span class="w"> </span><span class="s2">"key list_1"</span><span class="p">,</span><span class="w"> </span><span class="s2">"key list_2"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">key</span> <span class="kt">list</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">similar_content</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">similar_content</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"key list"</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span> <span class="s">"string"</span><span class="p">,</span> <span class="s">"string"</span> <span class="p">]</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>key list</td>
<td>out</td>
<td>key_list</td>
<td>List of volume keys</td>
</tr>
</tbody></table>
<h2 id='method-enable_cbt'>Method: <code>enable_cbt</code></h2>
<p>[enable_cbt sr volume] enables Changed Block Tracking for [volume]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.enable_cbt"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">25</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">enable_cbt</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">enable_cbt</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">enable_cbt</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">enable_cbt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
</tbody></table>
<h2 id='method-disable_cbt'>Method: <code>disable_cbt</code></h2>
<p>[disable_cbt sr volume] disables Changed Block Tracking for [volume]</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.disable_cbt"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">26</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">disable_cbt</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">disable_cbt</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">disable_cbt</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">disable_cbt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
</tbody></table>
<h2 id='method-data_destroy'>Method: <code>data_destroy</code></h2>
<p>[data_destroy sr volume] deletes the data of the snapshot [volume] without deleting its changed block tracking metadata</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.data_destroy"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w"> </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">27</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">data_destroy</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">data_destroy</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="kc">null</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="bp">()</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">data_destroy</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">data_destroy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
</tbody></table>
<h2 id='method-list_changed_blocks'>Method: <code>list_changed_blocks</code></h2>
<p>[list_changed_blocks sr volume1 volume2] returns the blocks that have changed between [volume1] and [volume2] as a base64-encoded bitmap string</p>

<blockquote>
<p>Client</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w">
  </span><span class="s2">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"Volume.list_changed_blocks"</span><span class="p">,</span><span class="w">
  </span><span class="s2">"params"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
    </span><span class="p">{</span><span class="w">
      </span><span class="s2">"length"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"offset"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w">
      </span><span class="s2">"key2"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key2"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"key"</span><span class="p">:</span><span class="w"> </span><span class="s2">"key"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"sr"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sr"</span><span class="p">,</span><span class="w">
      </span><span class="s2">"dbg"</span><span class="p">:</span><span class="w"> </span><span class="s2">"dbg"</span><span class="w">
    </span><span class="p">}</span><span class="w">
  </span><span class="p">],</span><span class="w">
  </span><span class="s2">"id"</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">changed_blocks</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">list_changed_blocks</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">key2</span> <span class="n">offset</span> <span class="n">length</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">"__main__"</span><span class="p">:</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">xapi</span><span class="o">.</span><span class="n">connect</span><span class="p">()</span>
    <span class="n">results</span> <span class="o">=</span> <span class="n">c</span><span class="o">.</span><span class="n">Volume</span><span class="o">.</span><span class="n">list_changed_blocks</span><span class="p">({</span> <span class="n">dbg</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">sr</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">key2</span><span class="p">:</span> <span class="s">"string"</span><span class="p">,</span> <span class="n">offset</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="n">length</span><span class="p">:</span> <span class="il">0L</span> <span class="p">})</span>
    <span class="k">print</span> <span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">results</span><span class="p">))</span>
</code></pre>
<blockquote>
<p>Server</p>
</blockquote>
<pre class="highlight json tab-json"><code><span class="p">{</span><span class="w"> </span><span class="s2">"bitmap"</span><span class="p">:</span><span class="w"> </span><span class="s2">"bitmap"</span><span class="p">,</span><span class="w"> </span><span class="s2">"granularity"</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">}</span><span class="w">
</span></code></pre><pre class="highlight ocaml tab-ocaml"><code><span class="k">try</span>
    <span class="k">let</span> <span class="n">changed_blocks</span> <span class="p">=</span> <span class="nn">Client</span><span class="p">.</span><span class="n">list_changed_blocks</span> <span class="n">dbg</span> <span class="n">sr</span> <span class="n">key</span> <span class="n">key2</span> <span class="n">offset</span> <span class="n">length</span> <span class="k">in</span>
    <span class="o">...</span>
<span class="k">with</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Sr_not_attached</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">SR_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Volume_does_not_exist</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Unimplemented</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Cancelled</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>
<span class="p">|</span> <span class="nc">Exn</span> <span class="p">(</span><span class="nc">Activated_on_another_host</span> <span class="n">str</span><span class="p">)</span> <span class="p">-&gt;</span> <span class="o">...</span>

</code></pre><pre class="highlight python tab-python"><code>
<span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="kn">import</span> <span class="nn">xapi</span>
<span class="kn">from</span> <span class="nn">storage</span> <span class="kn">import</span> <span class="o">*</span>

<span class="k">class</span> <span class="nc">Volume_myimplementation</span><span class="p">(</span><span class="n">Volume_skeleton</span><span class="p">):</span>
    <span class="c"># by default each method will return a Not_implemented error</span>
    <span class="c"># ...</span>
    <span class="k">def</span> <span class="nf">list_changed_blocks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dbg</span><span class="p">,</span> <span class="n">sr</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">key2</span><span class="p">,</span> <span class="n">offset</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
        <span class="s">"""Operations which operate on volumes (also known as  Virtual Disk Images)"""</span>
        <span class="n">result</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">result</span><span class="p">[</span><span class="s">"changed_blocks"</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span> <span class="s">"granularity"</span><span class="p">:</span> <span class="il">0L</span><span class="p">,</span> <span class="s">"bitmap"</span><span class="p">:</span> <span class="s">"string"</span> <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span>
    <span class="c"># ...</span>
</code></pre>
<table><thead>
<tr>
<th>Name</th>
<th>Direction</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>dbg</td>
<td>in</td>
<td>string</td>
<td>Debug context from the caller</td>
</tr>
<tr>
<td>sr</td>
<td>in</td>
<td>string</td>
<td>The Storage Repository</td>
</tr>
<tr>
<td>key</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>key2</td>
<td>in</td>
<td>key</td>
<td>The volume key</td>
</tr>
<tr>
<td>offset</td>
<td>in</td>
<td>int64</td>
<td>The offset of the extent for which changed blocks should be computed</td>
</tr>
<tr>
<td>length</td>
<td>in</td>
<td>int</td>
<td>The length of the extent for which changed blocks should be computed</td>
</tr>
<tr>
<td>changed_blocks</td>
<td>out</td>
<td>changed_blocks</td>
<td>The changed blocks between two volumes in the specified extent</td>
</tr>
</tbody></table>
<h2 id='errors'>Errors</h2><h3 id='exns'>exns</h3><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w"> </span><span class="s2">"Sr_not_attached"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"SR_does_not_exist"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Volume_does_not_exist"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Unimplemented"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Cancelled"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Activated_on_another_host"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre>
<p>type <code>exns</code> = variant { ... }</p>
<h4 id='constructors'>Constructors</h4>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Sr_not_attached</td>
<td>string</td>
<td>An SR must be attached in order to access volumes</td>
</tr>
<tr>
<td>SR_does_not_exist</td>
<td>string</td>
<td>The specified SR could not be found</td>
</tr>
<tr>
<td>Volume_does_not_exist</td>
<td>string</td>
<td>The specified volume could not be found in the SR</td>
</tr>
<tr>
<td>Unimplemented</td>
<td>string</td>
<td>The operation has not been implemented</td>
</tr>
<tr>
<td>Cancelled</td>
<td>string</td>
<td>The operation has not been implemented</td>
</tr>
<tr>
<td>Activated_on_another_host</td>
<td>string</td>
<td>The Volume is already active on another host</td>
</tr>
</tbody></table>
<h3 id='exns-2'>exns</h3><pre class="highlight json tab-json"><code><span class="p">[</span><span class="w"> </span><span class="s2">"Sr_not_attached"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"SR_does_not_exist"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Volume_does_not_exist"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Unimplemented"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Cancelled"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span><span class="p">[</span><span class="w"> </span><span class="s2">"Activated_on_another_host"</span><span class="p">,</span><span class="w"> </span><span class="s2">"exns"</span><span class="w"> </span><span class="p">]</span><span class="w">
</span></code></pre>
<p>type <code>exns</code> = variant { ... }</p>
<h4 id='constructors-2'>Constructors</h4>
<table><thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead><tbody>
<tr>
<td>Sr_not_attached</td>
<td>string</td>
<td>An SR must be attached in order to access volumes</td>
</tr>
<tr>
<td>SR_does_not_exist</td>
<td>string</td>
<td>The specified SR could not be found</td>
</tr>
<tr>
<td>Volume_does_not_exist</td>
<td>string</td>
<td>The specified volume could not be found in the SR</td>
</tr>
<tr>
<td>Unimplemented</td>
<td>string</td>
<td>The operation has not been implemented</td>
</tr>
<tr>
<td>Cancelled</td>
<td>string</td>
<td>The operation has not been implemented</td>
</tr>
<tr>
<td>Activated_on_another_host</td>
<td>string</td>
<td>The Volume is already active on another host</td>
</tr>
</tbody></table>

      </div>
      <div class="dark-box">
          <div class="lang-selector">
                <a href="#" data-language-name="json">json</a>
                <a href="#" data-language-name="ocaml">ocaml</a>
                <a href="#" data-language-name="python">python</a>
          </div>
      </div>
    </div>
  </body>
</html>
